import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage import label

# Parameters
L = 300
pv = [0.2, 0.3, 0.4, 0.5, 0.6, 0.7]

# Random matrix
z = np.random.rand(L, L)

plt.figure(figsize=(12, 8))

for i, p in enumerate(pv):
    m = z < p
    lw, num = label(m)
    
    # Assigns each cluster a unique color (0 = empty)
    if lw.max() > 0:
        b = np.arange(1, lw.max() + 1) #Leaves 0 for empty sites
        np.random.shuffle(b) #Shuffle cluster colours
        shuffledLw = np.zeros_like(lw)
        shuffledLw[lw > 0] = b[lw[lw > 0] - 1]
    else:
        shuffledLw = lw

    # Plot
    plt.subplot(2, 3, i + 1)
    plt.imshow(shuffledLw, origin="lower", cmap='nipy_spectral') #Map where 0 is assigned to black
    plt.title("Square Lattice with " + f"p = {p}")
    plt.axis('off')

plt.tight_layout()
plt.show()
